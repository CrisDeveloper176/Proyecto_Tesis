{% extends 'TemplatesBase/Base.html' %}

{% block content %}
<!-- Contenedor principal que ocupa toda la pantalla para el mapa -->
<div class="container-fluid position-relative vh-100 p-0">
    <!-- Contenedor del mapa -->
    <div id="map" class="w-100 h-100"></div>

    <!-- Menú flotante en la esquina superior izquierda para la lista de vehículos -->
    <div class="position-absolute top-0 start-0 m-3">
        <div class="dropdown">
            <button class="btn btn-primary dropdown-toggle w-100" type="button" id="vehicleDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                Vehículos disponibles
            </button>
            <ul class="dropdown-menu" aria-labelledby="vehicleDropdown" style="max-height: 200px; overflow-y: auto;">
                <li><a class="dropdown-item" href="#">Vehículo 1</a></li>
                <li><a class="dropdown-item" href="#">Vehículo 2</a></li>
                <li><a class="dropdown-item" href="#">Vehículo 3</a></li>
                <!-- Agrega más vehículos según sea necesario -->
            </ul>
        </div>
    </div>

    <!-- Menú flotante en la esquina superior derecha para información del vehículo -->
    <div class="position-absolute top-0 end-0 m-3">
        <div class="dropdown">
            <button class="btn btn-primary dropdown-toggle w-100" type="button" id="infoDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                Información del Vehículo
            </button>
            <div class="dropdown-menu p-3" aria-labelledby="infoDropdown" style="width: 250px;">
                <p><strong>Velocidad:</strong> <span>-- km/h</span></p>
                <p><strong>Tiempo de parada:</strong> <span>-- min</span></p>
                <p><strong>Matrícula:</strong> <span>--</span></p>
                <button class="btn btn-danger w-100 mt-2">Parar motor</button>
            </div>
        </div>
    </div>
</div>

<!-- Inicialización de Google Maps -->
<script>
    function initMap() {
        const mapOptions = {
            zoom: 12,
            center: { lat: -37.4667, lng: -72.5667 }  // Coordenadas centrales entre Laja y Huepil
        };
        const map = new google.maps.Map(document.getElementById('map'), mapOptions);

       

    }
</script>

<!-- Cargar la API de Google Maps -->
<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCERVqzsVAyNTs8EswdkCTgVevQtYah7HA&callback=initMap">
</script>

<script>
    function enviarUbicacion() {
        if (navigator.geolocation) {
            // Obtener la ubicación del dispositivo
            navigator.geolocation.getCurrentPosition(function(position) {
                const lat = position.coords.latitude;
                const lon = position.coords.longitude;

                // Crear un objeto con las coordenadas
                const datosUbicacion = {
                    lat: lat,
                    lon: lon
                };

                // Enviar la ubicación a la API de Django desplegada en Fly.io
                fetch('https://tu-api.fly.dev/api/ubicacion/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(datosUbicacion)
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Ubicación enviada:', data);
                })
                .catch(error => {
                    console.error('Error al enviar ubicación:', error);
                });
            });
        } else {
            alert("La geolocalización no está soportada por este navegador.");
        }
    }
</script>


{% endblock %}
